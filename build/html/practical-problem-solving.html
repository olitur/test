<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Practical problem solving &#8212; test</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/yeti/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/canopee_ico.ico"/>
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Working remotely" href="working-remotely.html" />
    <link rel="prev" title="Automation is your friend" href="automation-is-your-friend.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          test</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Yo!test <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preface.html#who-should-read-this-book">Who should read this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#licence">Licence</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#source-code">Source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#feedback">Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting-some-motivation.html">Getting some motivation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting-some-motivation.html#why-you-should-care-about-computing-and-coding">Why you should care about computing and coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-some-motivation.html#what-you-can-expect-to-learn-here">What you can expect to learn here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="how-to-think-like-a-computer.html">How to think like a computer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#binary-bits-and-bytes">Binary, bits and bytes</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#character-encodings">Character encodings</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#real-numbers">Real numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#boolean-logic">Boolean logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#the-microprocessor">The microprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#computer-memory">Computer memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-think-like-a-computer.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="first-steps-towards-automation.html">First steps towards automation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#first-things-first-how-to-find-help">First things first, how to find help</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#creating-a-new-directory-for-our-project">Creating a new directory for our project</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#downloading-the-swiss-prot-knowledge-base">Downloading the Swiss-Prot knowledge base</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#creating-a-work-flow-using-pipes">Creating a work flow using pipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#examining-files-without-modifying-them">Examining files, without modifying them</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#finding-fasta-identifier-lines-corresponding-to-human-proteins">Finding FASTA identifier lines corresponding to human proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#extracting-the-uniprot-identifiers">Extracting the UniProt identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#using-redirection-to-create-an-output-file">Using redirection to create an output file</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#viewing-the-command-history">Viewing the command history</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#clearing-the-terminal-window">Clearing the terminal window</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#copying-and-renaming-files">Copying and renaming files</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#removing-files-and-directories">Removing files and directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-towards-automation.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structuring-and-storing-data.html">Structuring and storing data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#data-structures">Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#data-persistence">Data persistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#the-beauty-of-plain-text-files">The beauty of plain text files</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#useful-plain-text-file-formats">Useful plain text file formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#tidy-data">Tidy data</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#find-a-good-text-editor-and-learn-how-to-use-it">Find a good text editor and learn how to use it</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-and-storing-data.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="keeping-track-of-your-work.html">Keeping track of your work</a><ul>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#what-is-git">What is Git?</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#first-time-configuration-of-git">First time configuration of Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#initialise-the-project">Initialise the project</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#create-a-script-for-downloading-the-swissprot-fasta-file">Create a script for downloading the SwissProt FASTA file</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#improve-script-for-downloading-swissprot-fasta-file">Improve script for downloading SwissProt FASTA file</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#create-script-for-counting-the-number-of-proteins-in-a-genome">Create script for counting the number of proteins in a genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#more-useful-git-commands">More useful git commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="keeping-track-of-your-work.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-analysis.html">Data analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#what-is-python">What is Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#using-python-in-interactive-mode">Using Python in interactive mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#determining-the-gc-count-of-a-sequence">Determining the GC count of a sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#creating-reusable-functions">Creating reusable functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#list-slicing">List slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#loops">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#creating-a-sliding-window-gc-content-function">Creating a sliding window GC-content function</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#downloading-the-genome">Downloading the genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#reading-and-writing-files">Reading and writing files</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#creating-a-function-for-reading-in-the-streptomyces-sequence">Creating a function for reading in the <em>Streptomyces</em> sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#writing-out-the-sliding-window-analysis">Writing out the sliding window analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-analysis.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-visualisation.html">Data visualisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#starting-r-and-loading-the-iris-flower-data-set">Starting R and loading the Iris flower data set</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#understanding-the-structure-of-the-iris-data-set">Understanding the structure of the <code class="docutils literal"><span class="pre">iris</span></code> data set</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#a-note-on-statistics-in-r">A note on statistics in R</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#default-plotting-in-r">Default plotting in R</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#installing-the-ggplot2-package">Installing the ggplot2 package</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#loading-the-ggplot2-package">Loading the ggplot2 package</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#plotting-using-ggplot2">Plotting using ggplot2</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#available-geoms">Available «&nbsp;Geoms&nbsp;»</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#scripting-data-visualisation">Scripting data visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#faceting">Faceting</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#adding-more-colour">Adding more colour</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#purpose-of-data-visualisation">Purpose of data visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#conveying-a-message-to-an-audience">Conveying a message to an audience</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#writing-a-caption">Writing a caption</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#other-useful-tools-for-scripting-the-generation-of-figures">Other useful tools for scripting the generation of figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-visualisation.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="collaborating-on-projects.html">Collaborating on projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#find-a-friend">Find a friend</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#get-a-github-or-bitbucket-account">Get a GitHub or BitBucket account</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#pushing-the-project-to-a-remote-server">Pushing the project to a remote server</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#collaboration-using-git">Collaboration using Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#working-in-parallel">Working in parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#resolving-conflicts">Resolving conflicts</a></li>
<li class="toctree-l2"><a class="reference internal" href="collaborating-on-projects.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="creating-scientific-documents.html">Creating scientific documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#starting-the-manuscript">Starting the manuscript</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#converting-the-document-to-html-using-pandoc">Converting the document to HTML using pandoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#adding-a-figure">Adding a figure</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#converting-the-document-to-pdf">Converting the document to PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#reference-management">Reference management</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#adding-meta-data">Adding meta data</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#benefits-of-using-pandoc-and-plain-text-files">Benefits of using Pandoc and plain text files</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#alternative-plain-text-approaches">Alternative plain text approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#using-non-plain-text-file-formats">Using non-plain text file formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-scientific-documents.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="automation-is-your-friend.html">Automation is your friend</a><ul>
<li class="toctree-l2"><a class="reference internal" href="automation-is-your-friend.html#introduction-to-make">Introduction to <code class="docutils literal"><span class="pre">make</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="automation-is-your-friend.html#creating-a-makefile">Creating a <code class="docutils literal"><span class="pre">Makefile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="automation-is-your-friend.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Practical problem solving</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stop-and-think">Stop and think</a></li>
<li class="toctree-l2"><a class="reference internal" href="#measuring-success">Measuring success</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-string-processing">More string processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extracting-the-organism-name">Extracting the organism name</a></li>
<li class="toctree-l2"><a class="reference internal" href="#only-running-tests-when-the-module-is-called-directly">Only running tests when the module is called directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#counting-the-number-of-unique-organisms">Counting the number of unique organisms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-the-number-of-variants-per-species-and-the-number-of-proteins-per-variant">Finding the number of variants per species and the number of proteins per variant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="working-remotely.html">Working remotely</a><ul>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#jargon-busting">Jargon busting</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#logging-in-using-the-secure-shell-protocol">Logging in using the Secure Shell protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#copying-files-using-secure-copy">Copying files using Secure Copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#password-less-authentication-using-ssh-keys">Password-less authentication using SSH keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#managing-your-login-details-using-ssh-config">Managing your login details using SSH config</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#executing-long-running-commands-on-remote-hosts">Executing long running commands on remote hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-remotely.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="managing-your-system.html">Managing your system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#the-file-system">The file system</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#the-path-environment-variable">The <code class="docutils literal"><span class="pre">PATH</span></code> environment variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#the-root-user">The <code class="docutils literal"><span class="pre">root</span></code> user</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#using-package-managers">Using package managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#compiling-software-from-source">Compiling software from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#installing-python-packages">Installing Python packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#installing-r-packages">Installing R packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#installing-perl-modules">Installing Perl modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#installing-latex-packages">Installing Latex packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#automated-provisioning">Automated provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="managing-your-system.html#key-concepts">Key concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="next-steps.html">Next steps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="next-steps.html#apply-what-you-have-learnt">Apply what you have learnt</a></li>
<li class="toctree-l2"><a class="reference internal" href="next-steps.html#be-social">Be social</a></li>
<li class="toctree-l2"><a class="reference internal" href="next-steps.html#recommended-reading">Recommended reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Practical problem solving</a><ul>
<li><a class="reference internal" href="#stop-and-think">Stop and think</a></li>
<li><a class="reference internal" href="#measuring-success">Measuring success</a></li>
<li><a class="reference internal" href="#more-string-processing">More string processing</a><ul>
<li><a class="reference internal" href="#the-python-string-object">The Python string object</a></li>
<li><a class="reference internal" href="#regular-expressions">Regular expressions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extracting-the-organism-name">Extracting the organism name</a></li>
<li><a class="reference internal" href="#only-running-tests-when-the-module-is-called-directly">Only running tests when the module is called directly</a></li>
<li><a class="reference internal" href="#counting-the-number-of-unique-organisms">Counting the number of unique organisms</a></li>
<li><a class="reference internal" href="#finding-the-number-of-variants-per-species-and-the-number-of-proteins-per-variant">Finding the number of variants per species and the number of proteins per variant</a></li>
<li><a class="reference internal" href="#key-concepts">Key concepts</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="practical-problem-solving">
<h1>Practical problem solving</h1>
<p>So far we have been learning about computing and coding.</p>
<p>The purpose of this chapter is to introduce some practical techniques for
tackling data analysis problems.</p>
<p>At this point we go back to looking at the Swiss-Prot FASTA file used in
<a class="reference internal" href="first-steps-towards-automation.html"><span class="doc">First steps towards automation</span></a>. You can download this file using
the <code class="docutils literal"><span class="pre">curl</span></code> command below.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ curl --location --output uniprot_sprot.fasta.gz http://bit.ly/1l6SAKb
</pre></div>
</div>
<p>The downloaded <code class="docutils literal"><span class="pre">uniprot_sprot.fasta.gz</span></code> file is gzipped. You can view the
content of this file without permanently unzipping it using the command below.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ gunzip -c uniprot_sprot.fasta.gz
</pre></div>
</div>
<p>If the <code class="docutils literal"><span class="pre">curl</span></code> and <code class="docutils literal"><span class="pre">gunzip</span></code> commands above look unfamiliar you may want to
review the <a class="reference internal" href="first-steps-towards-automation.html"><span class="doc">First steps towards automation</span></a> chapter.</p>
<p>By briefly inspecting some random FASTA description lines it becomes clear that
some species include variants. Below are some sample <em>E. coli</em> extracts from
the FASTA file.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>...IraP OS=Escherichia coli (strain SE11) GN=iraP PE=3 SV=1
...IraP OS=Escherichia coli (strain SMS-3-5 / SECEC) GN=iraP PE=3 SV=1
...IraP OS=Escherichia coli (strain UTI89 / UPEC) GN=iraP PE=3 SV=1
</pre></div>
</div>
<p>How many variants are there per species? Do all variants contain the same
number of proteins?</p>
<p>To answer these questions we will make use of the Python scripting language
and some practical problem solving techniques.</p>
<div class="section" id="stop-and-think">
<h2>Stop and think</h2>
<p>One of the most common mistakes when programming is to start coding before the
problem is clearly defined.</p>
<p>What do we want to achieve? Pause for a second and try to answer this question
to yourself. It may help trying to explain it out loud.</p>
<div class="sidebar">
<p class="first sidebar-title">Rubber duck debugging</p>
<p class="last">When faced with a tricky <a class="reference internal" href="glossary.html#term-bug"><span class="xref std std-term">bug</span></a> many programmers find that one of
the best methods to <a class="reference internal" href="glossary.html#term-debug"><span class="xref std std-term">debug</span></a> their code is to explain it to a
colleague. The act of verbalising ones assumptions often identifies the
problem at hand without the colleague having to do anything except listen.
This technique is so powerful that some programmers use a rubber duck,
as a substitute for a colleague, when the latter is unavailable. This method
is not limited to debugging, hence the suggestion to verbalise the problem
statement out loud.</p>
</div>
<p>Now describe all the steps required to achieve this goal. Again it may help
speaking out loud to yourself or imagining that you are describing the required
steps to a colleague.</p>
<p>Did you find that easy or difficult? Thinking about what one wants to achieve
and all the steps required to get there can often be quite overwhelming.
When this happens it is easy to think to oneself that the detail will become clear
later on and that one should stop wasting time and get on with the coding. Try
to avoid doing this. Rather, try to think of a simpler goal.</p>
<p>For example consider the goal of working out how many different species there
are in the FASTA file. This goal would require us to:</p>
<ol class="arabic simple">
<li>Identify all the description lines in the FASTA file</li>
<li>Extract the organism name from the line</li>
<li>Ensure that there are no duplicate entries</li>
<li>Count the number of entries</li>
</ol>
<p>If you know the tools and techniques required to do all of the steps above this
may not seem overwhelming. However, if you don’t it will. In either case it is
worthwhile to treat each step as a goal in itself and work out the sub-steps
required to achieve these. By iterating over this process you
will either get down to steps sizes that do not feel overwhelming or you will
identify the key aspect that you feel unsure about.</p>
<p>For example, the first step to identify all the description lines in the
FASTA file can be decomposed into the sub-steps below.</p>
<ol class="arabic simple">
<li>Create a list for storing the description lines</li>
<li>Iterate over all the lines in the input file</li>
<li>For each line check if it is a description line</li>
<li>If it is add the line to the list</li>
</ol>
<p>Now suppose one felt unsure about how to check if a line was a description
line. This would represent a good place to start experimenting with some actual
code. Can we come up with a code snippet that can check if a string is a FASTA
description line?</p>
</div>
<div class="section" id="measuring-success">
<h2>Measuring success</h2>
<p>Up until this point we have been testing our code snippets by running the code
and verifying the results manually. This is terribly inefficient and soon breaks
down once you have more than one thing to test.</p>
<p>It is much better to write tests that can be run automatically.  Let’s examine
this concept. Create a file named <code class="docutils literal"><span class="pre">fasta_utils.py</span></code> and add the Python
code below to it.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>

<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The first line is a module level «&nbsp;docstring&nbsp;» and it is used to explain the
intent of the module as a whole.  A «&nbsp;module&nbsp;» is basically a file with a <code class="docutils literal"><span class="pre">.py</span></code>
extension, i.e. a Python file. Modules are used to group related functionality
together.</p>
<p>Lines three to five represent a function named <code class="xref py py-func docutils literal"><span class="pre">test_is_description_line()</span></code>.
Python functions consist of two parts: the function definition (line 3) and the
function body (lines 4 and 5).</p>
<p>In Python functions are defined using the <code class="docutils literal"><span class="pre">def</span></code> keyword. Note that the
<code class="docutils literal"><span class="pre">def</span></code> keyword is followed by the name of the function. The name of the
function is followed by a parenthesized set of arguments, in this case the
function takes no arguments. The end of the function definition is marked using
a colon.</p>
<p>The body of the function, lines four and five, need to be indented. The standard
in Python is to use four white spaces to indent code blocks.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Whitespace really matters in Python! If your code is not correctly
aligned you will see <code class="docutils literal"><span class="pre">IndentationError</span></code> messages telling you
that everything is not as it should be. You will also run into
<code class="docutils literal"><span class="pre">IndentationError</span></code> messages if you mix white spaces and tabs.</p>
</div>
<p>The first line of the function body, line four, is a docstring explaining the
intent of the function.  Line five makes use of the built-in <code class="docutils literal"><span class="pre">print()</span></code>
function to write a string to the <a class="reference internal" href="glossary.html#term-standard-output-stream"><span class="xref std std-term">standard output stream</span></a>. Python’s built-in
<code class="docutils literal"><span class="pre">print()</span></code> function is similar to the <code class="docutils literal"><span class="pre">echo</span></code> command we used earlier in
<a class="reference internal" href="keeping-track-of-your-work.html"><span class="doc">Keeping track of your work</span></a>.</p>
<p>Finally, on line seven the <code class="xref py py-func docutils literal"><span class="pre">test_is_description_line()</span></code> function is called,
i.e. the logic within the function’s body is executed. In this instance this
means that the <code class="docutils literal"><span class="pre">&quot;Testing</span> <span class="pre">the</span> <span class="pre">is_description_line()</span> <span class="pre">function...&quot;</span></code> string is
written to the standard output stream.</p>
<p>Let us run this script in a terminal. To run a Python script we use the <code class="docutils literal"><span class="pre">python</span></code>
command followed by the name of the script.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
</pre></div>
</div>
<p>So far so good? At the moment our <code class="xref py py-func docutils literal"><span class="pre">test_is_description_line()</span></code> function
does not actually test anything. Let us rectify that now.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>
<span class="hll">    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;&gt;This is a description line&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span>
</span>
<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>There are quite a few things going on in the newly added line. First of all it
makes use of three built-in features of Python: the <code class="docutils literal"><span class="pre">assert</span></code> and <code class="docutils literal"><span class="pre">is</span></code>
keywords, as well as the <code class="docutils literal"><span class="pre">True</span></code> constant. Let’s work through these in reverse
order.</p>
<p>Python has some <a class="reference external" href="https://docs.python.org/2/library/constants.html">built-in constants</a>, most notably <code class="docutils literal"><span class="pre">True</span></code>,
<code class="docutils literal"><span class="pre">False</span></code> and <code class="docutils literal"><span class="pre">None</span></code>. The <code class="docutils literal"><span class="pre">True</span></code> and <code class="docutils literal"><span class="pre">False</span></code> constants are the only
instances of the <code class="docutils literal"><span class="pre">bool</span></code> (boolean) type and <code class="docutils literal"><span class="pre">None</span></code> is often used to
represent the absence of a value.</p>
<p>In Python <code class="docutils literal"><span class="pre">is</span></code> is an operator that checks for object identity, i.e. if the
object returned by the <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function and <code class="docutils literal"><span class="pre">True</span></code> are
the same object. If they are the same object the comparison evaluates to
<code class="docutils literal"><span class="pre">True</span></code> if not it evaluates to <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">assert</span></code> keyword is used to insert debugging statements into a program.
It provides a means to ensure that the state of a program is as expected. If
the statement evaluates to <code class="docutils literal"><span class="pre">False</span></code> an <code class="docutils literal"><span class="pre">AssertionError</span></code> is raised.</p>
<p>So, what will happen if we run the code in its current form?
Well, we have not yet defined the <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function, so
Python will raise a <code class="docutils literal"><span class="pre">NameError</span></code>. Let us run the code.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 8, in &lt;module&gt;
    test_is_description_line()
  File &quot;fasta_utils.py&quot;, line 6, in test_is_description_line
    assert is_description_line(&quot;&gt;This is a description line&quot;) is True
NameError: global name &#39;is_description_line&#39; is not defined
</pre></div>
</div>
<p>Great now we are getting somewhere! What? Well, we have impemented some
code to test the functionality of the <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> and it
tells us that the function does not exist. This is useful information.
Let us add a placeholder <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function to the Python
module.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="hll"><span class="k">def</span> <span class="nf">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Return True if the line is a FASTA description line.&quot;&quot;&quot;</span>
</span>
<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;&gt;This is a description line&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span>

<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Note that the function we have added on lines three and four currently does nothing.
By default the function will return <code class="docutils literal"><span class="pre">None</span></code>.  However, when we run the script
we should no longer get a <code class="docutils literal"><span class="pre">NameError</span></code>. Let’s find out what happens when we
run the code.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 11, in &lt;module&gt;
    test_is_description_line()
  File &quot;fasta_utils.py&quot;, line 9, in test_is_description_line
    assert is_description_line(&quot;&gt;This is a description line&quot;) is True
AssertionError
</pre></div>
</div>
<p>More progress! Now we see the expected <code class="docutils literal"><span class="pre">AssertionError</span></code>, becuase <code class="docutils literal"><span class="pre">None</span></code> is
not <code class="docutils literal"><span class="pre">True</span></code>. Let us add some code to try to get rid of this error message. To
achieve this we simply need to make the function return <code class="docutils literal"><span class="pre">True</span></code>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if the line is a FASTA description line.&quot;&quot;&quot;</span>
<span class="hll">    <span class="k">return</span> <span class="bp">True</span>
</span>
<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;&gt;This is a description line&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span>

<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Now, we can run the code again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
</pre></div>
</div>
<p>No error message, the code is now working to the specification described in the test.
However, the test does not specify what the behaviour should be for a biological
sequence line. Let us add another assert statement to specify this.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if the line is a FASTA description line.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;&gt;This is a description line&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="hll">    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;ATCG&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span>
</span>
<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Now we can run the code again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 13, in &lt;module&gt;
    test_is_description_line()
  File &quot;fasta_utils.py&quot;, line 11, in test_is_description_line
    assert is_description_line(&quot;ATCG&quot;) is False
AssertionError
</pre></div>
</div>
<p>More progress, we now have a test to ensure that the <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function
returns <code class="docutils literal"><span class="pre">False</span></code> when the input line is a sequence. Let us try to implement the desired
functionality to make the test pass. For this we will use the
<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#str.startswith">startswith()</a> method,
that is built into strings, to check if the string starts with a greater than (<code class="docutils literal"><span class="pre">&gt;</span></code>) character.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if the line is a FASTA description line.&quot;&quot;&quot;</span>
<span class="hll">    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">True</span>
</span><span class="hll">    <span class="k">else</span><span class="p">:</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">False</span>
</span>
<span class="k">def</span> <span class="nf">test_is_description_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test the is_description_line() function.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the is_description_line() function...&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;&gt;This is a description line&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span>
    <span class="k">assert</span> <span class="n">is_description_line</span><span class="p">(</span><span class="s2">&quot;ATCG&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span>

<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>In the code above we make use of conditional logic, i.e. <code class="docutils literal"><span class="pre">if</span></code> something is
<code class="docutils literal"><span class="pre">True</span></code> the code does something otherwise it does something <code class="docutils literal"><span class="pre">else</span></code>. As mentioned previously
whitespace is important in Python and four spaces are used to indent the lines after
the <code class="docutils literal"><span class="pre">if</span></code> and <code class="docutils literal"><span class="pre">else</span></code> statements to tell Python which statement(s) belong in the conditional
code blocks. In this case we only have one statement per conditional, but it is
possible to group several statements together based on their indentation.</p>
<p>Let us test the code again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
</pre></div>
</div>
<p>Fantastic the code behaves in the way that we want it to behave!</p>
<p>However, the current implementation of the <code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function
is a little bit verbose. Do we really need the <code class="docutils literal"><span class="pre">else</span></code> conditional?  What
would happen if it was not there?</p>
<p>The beauty of tests now become more apparent. We can start experimenting with
the implementation of a function and feel confident that we are not breaking
it. As long as the tests do not fail that is!</p>
<p>Let us test out our hypothesis that the <code class="docutils literal"><span class="pre">else</span></code> conditional is redundant by
removing it and de-denting the <code class="docutils literal"><span class="pre">return</span> <span class="pre">False</span></code> statement.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if the line is a FASTA description line.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
<span class="hll">    <span class="k">return</span> <span class="bp">False</span>
</span></pre></div>
</td></tr></table></div>
<p>Now we can simply run the tests to see what happens.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
</pre></div>
</div>
<p>Amazing, we just made a change to our code and we can feel pretty sure that it is
still working as intended. This is very powerful. Incidentally, the code works
by virtue of the fact that if the <code class="docutils literal"><span class="pre">return</span> <span class="pre">True</span></code> statement is reached the function
returns <code class="docutils literal"><span class="pre">True</span></code> and exits, as such the second <code class="docutils literal"><span class="pre">return</span></code> statement is not called.</p>
<p>The methodology used in this section is known as Test-Driven Development, often
referred to as TDD. It involves three steps:</p>
<ol class="arabic simple">
<li>Write a test</li>
<li>Write minimal code to make the test pass</li>
<li>Refactor the code if necessary</li>
</ol>
<p>In this instance we started off by writing a test checking that the
<code class="xref py py-func docutils literal"><span class="pre">is_description_line()</span></code> function returned <code class="docutils literal"><span class="pre">True</span></code> when the input was a
description line.  We then added <em>minimal</em> code to make the test pass, i.e.  we
simply made the function return <code class="docutils literal"><span class="pre">True</span></code>. At this point no refactoring was
needed so we added another test to check that the function returned <code class="docutils literal"><span class="pre">False</span></code>
when the input was a sequence line. We then added some naive code to make the
tests pass.  At this point, we believed that there was scope to improve the
implementation of the function, so we refactored it to remove the redundant
<code class="docutils literal"><span class="pre">else</span></code> statement.</p>
<p>Well done! That was a lot of information. Go make yourself a cup of tea.</p>
</div>
<div class="section" id="more-string-processing">
<h2>More string processing</h2>
<p>Because information about DNA and proteins are often stored in plain text files
many aspects of biological data processing involves manipulating text. In
computing text is often referred to as strings of characters. String
manipulation is is therefore a common task both for processing biological
sequences and for interpreting sequence identifiers.</p>
<p>This section will provide a brief summary of how Python can be used for
such string processing.</p>
<p>Start Python in its interactive mode by typing <code class="docutils literal"><span class="pre">python</span></code> into the terminal.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python
Python 2.7.10 (default, Jul 14 2015, 19:46:27)
[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;
</pre></div>
</div>
<div class="section" id="the-python-string-object">
<h3>The Python string object</h3>
<p>When parsing in strings from a text file one often has to deal with lines that
have leading and/or trailing white spaces. Commonly one wants to get rid of them.
This can be achieved using the <code class="docutils literal"><span class="pre">strip()</span></code> method built into the string object.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;  text with leading/trailing spaces &quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">&#39;text with leading/trailing spaces&#39;</span>
</pre></div>
</div>
<p>Another common use case is to replace a word in a line. For example,
when we strip out the leading and trailing white spaces one might want to
update the word «&nbsp;with&nbsp;» to «&nbsp;without&nbsp;» to make the resulting string reflect
its current state. This can be achieved using the <code class="docutils literal"><span class="pre">replace()</span></code> method.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;  text with leading/trailing spaces &quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;with&quot;</span><span class="p">,</span> <span class="s2">&quot;without&quot;</span><span class="p">)</span>
<span class="go">&#39;text without leading/trailing spaces&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the example above we chain the <code class="docutils literal"><span class="pre">strip()</span></code> and <code class="docutils literal"><span class="pre">replace()</span></code> methods
together. In practise this means that the <code class="docutils literal"><span class="pre">replace()</span></code> methods acts
on the return value of the <code class="docutils literal"><span class="pre">strip()</span></code> method.</p>
</div>
<div class="sidebar">
<p class="first sidebar-title">What is the difference between a function and a method?</p>
<p class="last">Often the two terms are used interchangeably. However, a method refers
to a function that is part of a class and the term function refers to
a function which stands on its own.</p>
</div>
<p>Earlier we saw how the <code class="docutils literal"><span class="pre">startswith()</span></code> method can be used to identify FASTA
description lines.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;&gt;MySeq1|description line&quot;</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">endswith()</span></code> method complements the <code class="docutils literal"><span class="pre">startswith()</span></code> method and is often
used to examine file extensions.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;/home/olsson/images/profile.png&quot;</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This example above only works if the file extension is in lower case.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;/home/olsson/images/profile.PNG&quot;</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>However, we can overcome this issue by adding a call to the <code class="docutils literal"><span class="pre">lower()</span></code> method,
which converts the string to lower case.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;/home/olsson/images/profile.PNG&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another common use case is to search for a particular string within
another string. For example one might want to find out if the UniProt
identifier «&nbsp;Q6GZX4&nbsp;» is present in a FASTA description line. To achieve this one
can use the <code class="docutils literal"><span class="pre">find()</span></code> method, which returns the index position (zero-based)
where the search term was first identified.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;&gt;sp|Q6GZX4|001R_FRG3G&quot;</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Q6GZX4&quot;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>If the search term is not identified <code class="docutils literal"><span class="pre">find()</span></code> returns -1.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;&gt;sp|P31946|1433B_HUMAN&quot;</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Q6GZX4&quot;</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>When iterating over lines in a file one often wants to split the line based on a
delimiter. This can be achieved using the <code class="docutils literal"><span class="pre">split()</span></code> method. By default this
splits on white space characters and returns a list of strings.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;text without leading/trailing spaces&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="go">[&#39;text&#39;, &#39;without&#39;, &#39;leading/trailing&#39;, &#39;spaces&#39;]</span>
</pre></div>
</div>
<p>A different delimiter can be used by providing it as an argument to the <code class="docutils literal"><span class="pre">split()</span></code>
method.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;&gt;sp|Q6GZX4|001R_FRG3G&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
<span class="go">[&#39;&gt;sp&#39;, &#39;Q6GZX4&#39;, &#39;001R_FRG3G&#39;]</span>
</pre></div>
</div>
<p>There are many variations on the string operators described above. It is useful
to familiarise yourself with the
<a class="reference external" href="https://docs.python.org/2/library/string.html">Python documentation on strings</a>.</p>
</div>
<div class="section" id="regular-expressions">
<h3>Regular expressions</h3>
<p>Regular expressions can be defined as a series of characters that define a
search pattern.</p>
<p>Regular expressions can be very powerful. However, they can be
difficult to build up. Often it is a process of trial and error. This means
that once they have been created, and the trial and error process has been
forgotten, it can be extremely difficult to understand what the regular
expression does and why it is constructed the way it is.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Use regular expression as a last resort. A good rule of thumb is
to always try to use string operations to implement the
desired functionality and only switch to regular expressions when
the code implemented using these operations becomes more
difficult to understand than the equivalent regular expression.</p>
</div>
<p>To use regular expressions in Python we need to import the <code class="xref py py-mod docutils literal"><span class="pre">re</span></code> module.
The <code class="xref py py-mod docutils literal"><span class="pre">re</span></code> module is part of Python’s standard library. Importing modules
in Python is achieved using the <code class="docutils literal"><span class="pre">import</span></code> keyword.</p>
<div class="sidebar">
<p class="first sidebar-title">What is a standard library?</p>
<p class="last">In computing a standard library refers to a set of functionality
that comes built-in with the core programming language.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
<p>Let us store a FASTA description line in a variable.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fasta_desc</span> <span class="o">=</span> <span class="s2">&quot;&gt;sp|Q6GZX4|001R_FRG3G&quot;</span>
</pre></div>
</div>
<p>Now, let us search for the UniProt identifer <code class="docutils literal"><span class="pre">Q6GZX4</span></code> within the line.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Q6GZX4&quot;</span><span class="p">,</span> <span class="n">fasta_desc</span><span class="p">)</span>  
<span class="go">&lt;_sre.SRE_Match object at 0x...&gt;</span>
</pre></div>
</div>
<p>There are two things to note here:</p>
<ol class="arabic simple">
<li>We use a raw string to represent our regular expression, i.e. the string prefixed with an <code class="docutils literal"><span class="pre">r</span></code></li>
<li>The regular expression <code class="docutils literal"><span class="pre">search()</span></code> method returns a match object (or None if no match is found)</li>
</ol>
<div class="sidebar">
<p class="first sidebar-title">What is a «&nbsp;raw string&nbsp;»?</p>
<p>In Python «&nbsp;raw&nbsp;» strings differ from regular strings in that the bashslash
<code class="docutils literal"><span class="pre">\</span></code> character is interpreted literally. For example the regular string
equivalent of <code class="docutils literal"><span class="pre">r&quot;\n&quot;</span></code> would be <code class="docutils literal"><span class="pre">&quot;\\n&quot;</span></code> where the first backslash is used
to escape the effect of the second (remember that <code class="docutils literal"><span class="pre">\n</span></code> represents a
newline).</p>
<p class="last">Raw strings were introduced in Python to make it easier to create regular
expressions that rely heavily on the use of literal backslashes.</p>
</div>
<p>The index of the first matched character can be accessed using the match
object’s <code class="docutils literal"><span class="pre">start()</span></code> method.  The match object also has an <code class="docutils literal"><span class="pre">end()</span></code> method
that returns the index of the last character + 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Q6GZX4&quot;</span><span class="p">,</span> <span class="n">fasta_desc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">fasta_desc</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">():</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()])</span>
<span class="gp">...</span>
<span class="go">Q6GZX4</span>
</pre></div>
</div>
<p>In the above we make use of the fact that Python strings support slicing.
Slicing is a means to access a subsection of a sequence.  The <code class="docutils literal"><span class="pre">[start:end]</span></code>
syntax is inclusive for the start index and exclusive for the end index.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;012345&quot;</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;23&#39;</span>
</pre></div>
</div>
<p>To see the merit of regular expressions we need to create one that matches more
than one thing.  For example a regular expression that could match all the
patterns <code class="docutils literal"><span class="pre">id0</span></code>, <code class="docutils literal"><span class="pre">id1</span></code>, …, <code class="docutils literal"><span class="pre">id9</span></code>.</p>
<p>Now suppose that we had a list containing FASTA description lines with these
types of identifiers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fasta_desc_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&gt;id0 match this&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s2">&quot;&gt;id9 and this&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s2">&quot;&gt;id100 but not this (initially)&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s2">&quot;AATCG&quot;</span><span class="p">]</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Note that the list above also contains a sequence line that we
never want to match.</p>
<p>Let us loop over the items in this list and print out the lines that match our
identifier regular expression.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_desc_list</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&gt;id[0-9]\s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">&gt;id0 match this</span>
<span class="go">&gt;id9 and this</span>
</pre></div>
</div>
<p>There are two noteworthy aspects of the regular
expression. Firstly, the <code class="docutils literal"><span class="pre">[0-9]</span></code> syntax means match any digit.
Secondly, the <code class="docutils literal"><span class="pre">\s</span></code> regular
expression meta character means match any white space character.</p>
<div class="sidebar">
<p class="first sidebar-title">The <code class="docutils literal"><span class="pre">[0-9]</span></code> syntax works in Bash too!</p>
<p>For example to list the files <code class="docutils literal"><span class="pre">photo_0.png</span></code>, <code class="docutils literal"><span class="pre">photo_1.png</span></code>,
…, <code class="docutils literal"><span class="pre">photo_9.png</span></code> you could use the command.</p>
<div class="last highlight-none"><div class="highlight"><pre><span></span>$ ls photo_[0-9].png
</pre></div>
</div>
</div>
<p>If one wanted to create a regular expression to match an identifier with an
arbitrary number of digits one can make use of the <code class="docutils literal"><span class="pre">*</span></code> meta character, which
causes the regular expression to match the preceding expression 0 or more times.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_desc_list</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&gt;id[0-9]*\s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">&gt;id0 match this</span>
<span class="go">&gt;id9 and this</span>
<span class="go">&gt;id100 but not this (initially)</span>
</pre></div>
</div>
<p>It is possible to extract specific pieces of information from a line using
regular expressions. This uses a concept known as «&nbsp;groups&nbsp;», which are indicated
using parenthesis. Let us try to extract the UniProt identifier from a FASTA
description line.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">fasta_desc</span><span class="p">)</span>
<span class="go">&gt;sp|Q6GZX4|001R_FRG3G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&gt;sp\|([A-Z,0-9]*)\|&quot;</span><span class="p">,</span> <span class="n">fasta_desc</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Note how horrible and incomprehensible the regular expression is.</p>
</div>
<p>It took me a couple of attempts to get this regular expression right as I
forgot that <code class="docutils literal"><span class="pre">|</span></code> is a regular expression meta character that needs to be
escaped using a backslash <code class="docutils literal"><span class="pre">\</span></code>.</p>
<p>The regular expression representing the UniProt idendifier <code class="docutils literal"><span class="pre">[A-Z,0-9]*</span></code> means
match capital letters (<code class="docutils literal"><span class="pre">A-Z</span></code>) and digits (<code class="docutils literal"><span class="pre">0-9</span></code>) zero or more times (<code class="docutils literal"><span class="pre">*</span></code>).
The UniProt regular expression is enclosed in parenthesis. The parenthesis
denote that the UniProt identifier is a group that we would like access to. In
other words, the purpose of a group is to give the user access to a section of
interest within the regular expression.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;Q6GZX4&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Everything matched by the regular expression.</span>
<span class="go">&#39;&gt;sp|Q6GZX4|&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;Q6GZX4&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is a difference between the <code class="docutils literal"><span class="pre">groups()</span></code> and the <code class="docutils literal"><span class="pre">group()</span></code>
methods. The former returns a tuple containing all the groups
defined in the regular expression. The latter takes an integer as
input and returns a specific group. However, confusingly <code class="docutils literal"><span class="pre">group(0)</span></code>
returns everything matched by the regular expression and <code class="docutils literal"><span class="pre">group(1)</span></code>
returns the first group making the <code class="docutils literal"><span class="pre">group()</span></code> method appear as if
it used a one-based indexing scheme.</p>
</div>
<p>Finally Let us have a look at a common pitfall when using regular expressions
in Python: the difference between the methods search() and match().</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;my cat has a hat&quot;</span><span class="p">))</span>  
<span class="go">&lt;_sre.SRE_Match object at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;my cat has a hat&quot;</span><span class="p">))</span>  
<span class="go">None</span>
</pre></div>
</div>
<p>Basically <code class="docutils literal"><span class="pre">match()</span></code> only looks for a match at the beginning of the string to
be searched. For more information see the
<a class="reference external" href="https://docs.python.org/2/library/re.html#search-vs-match">search() vs match()</a>
section in the Python documentation.</p>
<p>There is a lot more to regular expressions in particular all the meta
characters. For more information have a look at the
<a class="reference external" href="https://docs.python.org/2/library/re.html">regular expressions operations</a>
section in the Python documentation.</p>
</div>
</div>
<div class="section" id="extracting-the-organism-name">
<h2>Extracting the organism name</h2>
<p>Armed with our new found knowledge of string processing let’s create a function
for extracting the organism name from a SwissProt FASTA description line. In
other words given the lines:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;sp|P01090|2SS2_BRANA Napin-2 OS=Brassica napus PE=2 SV=2
&gt;sp|Q15942|ZYX_HUMAN Zyxin OS=Homo sapiens GN=ZYX PE=1 SV=1
&gt;sp|Q6QGT3|A1_BPT5 A1 protein OS=Escherichia phage T5 GN=A1 PE=2 SV=1
</pre></div>
</div>
<p>We would like to extract the strings:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Brassica napus
Homo sapiens
Escherichia phage T5
</pre></div>
</div>
<p>There are three things which are worth noting:</p>
<ol class="arabic simple">
<li>The organism name string is always preceeded by the key <code class="docutils literal"><span class="pre">OS</span></code> (Organism Name)</li>
<li>The organism name string can contain more than two words</li>
<li>The two letter key after the organism name string can vary, in the case
above we see both <code class="docutils literal"><span class="pre">PS</span></code> (Protein Existence) and <code class="docutils literal"><span class="pre">GE</span></code> (Gene Name)</li>
</ol>
<p>For more information about the UniProt FASTA description line go to <a class="reference external" href="http://www.uniprot.org/help/fasta-headers">UniProt’s
FASTA header</a> page.</p>
<p>The three FASTA description lines examined above provide an excellent basis for
creating a test for the function that we want. Add the lines below
to your <code class="docutils literal"><span class="pre">fasta_utils.py</span></code> file.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">test_extract_organism_name</span><span class="p">():</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Test the extract_organism_name() function.&quot;&quot;&quot;</span>
</span><span class="hll">    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the extract_organism_name() function...&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&gt;sp|P01090|2SS2_BRANA Napin-2 OS=Brassica napus PE=2 SV=2&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="s2">&quot;&gt;sp|Q15942|ZYX_HUMAN Zyxin OS=Homo sapiens GN=ZYX PE=1 SV=1&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="s2">&quot;&gt;sp|Q6QGT3|A1_BPT5 A1 protein OS=Escherichia phage T5 GN=A1 PE=2 SV=1&quot;</span><span class="p">]</span>
</span><span class="hll">    <span class="n">organism_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Brassica napus&quot;</span><span class="p">,</span> <span class="s2">&quot;Homo sapiens&quot;</span><span class="p">,</span> <span class="s2">&quot;Escherichia phage T5&quot;</span><span class="p">]</span>
</span><span class="hll">    <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">organism_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">organism_names</span><span class="p">):</span>
</span><span class="hll">        <span class="k">assert</span> <span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="n">organism_name</span>
</span>
<span class="n">test_is_description_line</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>In the above we make use of pythons built-in <code class="xref py py-func docutils literal"><span class="pre">zip()</span></code> function. This function takes two
lists as inputs and returns a list with paired values from the input lists.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)]</span>
</pre></div>
</div>
<p>Let’s make sure that the tests fail.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
</pre></div>
</div>
<p>What, no error message, what is going on? Ah, we added the test, but forgot to
add a line to call it. Let’s rectify that.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">test_is_description_line</span><span class="p">()</span>
<span class="hll"><span class="n">test_extract_organism_name</span><span class="p">()</span>
</span></pre></div>
</td></tr></table></div>
<p>Let’s try again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 26, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 23, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name
NameError: global name &#39;extract_organism_name&#39; is not defined
</pre></div>
</div>
<p>Success! We now have a failing test informing us that we need to create the
<code class="xref py py-func docutils literal"><span class="pre">extract_organism_name()</span></code> function. Let’s do that.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Return the organism name from a FASTA description line.&quot;&quot;&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>Let’s find out where this minimal implementation gets us.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 29, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 26, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name
AssertionError
</pre></div>
</div>
<p>The test fails as expected. However, since we are looping over many input
lines it would be good to get an idea of which test failed. We can achieve this
by making use of the fact that we can provide a custom message to be passed to
the <code class="docutils literal"><span class="pre">AssertionError</span></code>. Let us pass it the input line. Note the addition of the
trailing <code class="docutils literal"><span class="pre">,</span> <span class="pre">line</span></code> in line 26.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">organism_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">organism_names</span><span class="p">):</span>
<span class="hll">        <span class="k">assert</span> <span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="n">organism_name</span><span class="p">,</span> <span class="n">line</span>
</span></pre></div>
</td></tr></table></div>
<p>Let’s see what we get now.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 29, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 26, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name, line
AssertionError: &gt;sp|P01090|2SS2_BRANA Napin-2 OS=Brassica napus PE=2 SV=2
</pre></div>
</div>
<p>Much better! Let us try to implement a basic regular expression to make this
pass. First of all we need to make sure we import the <code class="xref py py-mod docutils literal"><span class="pre">re</span></code>
module.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Module containing utility functions for working with FASTA files.&quot;&quot;&quot;</span>

<span class="hll"><span class="kn">import</span> <span class="nn">re</span>
</span></pre></div>
</td></tr></table></div>
<p>Then we can implement a regular expression to try to extract the organism name.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Return the organism name from a FASTA description line.&quot;&quot;&quot;</span>
</span><span class="hll">    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;OS=(.*) PE=&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
<p>Remember the <code class="docutils literal"><span class="pre">.*</span></code> means match any character zero or more times and the
surrounding parenthesis creates a group.</p>
<p>Let us see what happens now.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 34, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 31, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name, line
AssertionError: &gt;sp|Q15942|ZYX_HUMAN Zyxin OS=Homo sapiens GN=ZYX PE=1 SV=1
</pre></div>
</div>
<p>Progress! We are now seeing a different error message. The issue is that the key after
the regular expression is <code class="docutils literal"><span class="pre">GN</span></code> rather than <code class="docutils literal"><span class="pre">PE</span></code>. Let us try to rectify that.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the organsim name from a FASTA description line.&quot;&quot;&quot;</span>
<span class="hll">    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;OS=(.*) [A-Z]{2}=&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The regular expression now states that instead of <code class="docutils literal"><span class="pre">PE</span></code> it wants any capital
letter <code class="docutils literal"><span class="pre">[A-Z]</span></code> repeated twice <code class="docutils literal"><span class="pre">{2}</span></code>. Let’s find out if this fixes the issue.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 33, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 30, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name, line
AssertionError: &gt;sp|P01090|2SS2_BRANA Napin-2 OS=Brassica napus PE=2 SV=2
</pre></div>
</div>
<p>What, back at square one again? As mentioned previously, regular expressions can be painful
and should only be used as a last resort. This also exemplifies why it is
important to have tests. Sometimes you think you make an innocuous change, but instead things
just fall apart.</p>
<p>At this stage the error message is not very useful, let us change it to print
out the value returned by the function instead.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">organism_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">organism_names</span><span class="p">):</span>
<span class="hll">        <span class="k">assert</span> <span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="n">organism_name</span><span class="p">,</span> <span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
<p>Now, let’s see what is going on.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 33, in &lt;module&gt;
    test_extract_organism_name()
  File &quot;fasta_utils.py&quot;, line 30, in test_extract_organism_name
    assert extract_organism_name(line) == organism_name, extract_organism_name(line)
AssertionError: Brassica napus PE=2
</pre></div>
</div>
<p>Our regular expression is basically matching too much. The reason for this is that the
<code class="docutils literal"><span class="pre">*</span></code> meta character acts in a «&nbsp;greedy&nbsp;» fashion matching as much as possible,
see <a class="reference internal" href="#greedy-vs-non-greedy-regular-expression"><span class="std std-numref">Fig. 20</span></a>. In this case
the <code class="docutils literal"><span class="pre">PE=2</span></code> is included in the match group as <code class="docutils literal"><span class="pre">[A-Z]{2}</span></code> is matched by the <code class="docutils literal"><span class="pre">SV=</span></code> key
at the end of the line. The fix is to make the <code class="docutils literal"><span class="pre">*</span></code> meta character act in a «&nbsp;non-greedy&nbsp;»
fashion. This is achieved by adding a <code class="docutils literal"><span class="pre">?</span></code> suffix to it.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the organism name from a FASTA description line.&quot;&quot;&quot;</span>
<span class="hll">    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;OS=(.*?) [A-Z]{2}=&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Let’s find out what happens now.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
</pre></div>
</div>
<p>All the tests pass! Well done, time for another cup of tea.</p>
<div class="figure" id="id1">
<span id="greedy-vs-non-greedy-regular-expression"></span><img alt="Greedy vs non-greedy regular expression." src="_images/greedy-regex.png" />
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">Figure illustrating the difference between a greedy and a non-greedy regular
expression. The <code class="docutils literal"><span class="pre">*</span></code> meta-character causes the previous regular expression,
in this case the any character (<code class="docutils literal"><span class="pre">.</span></code>), to be matched zero or more times.
This is done in a greedy fashion, i.e. trying to match as much text as
possible.  To make that part of the regular expression match as little text
as possible, i.e. to work in a non-greedy fashion, we use the meta-character
<code class="docutils literal"><span class="pre">*?</span></code>.</span></p>
</div>
</div>
<div class="section" id="only-running-tests-when-the-module-is-called-directly">
<h2>Only running tests when the module is called directly</h2>
<p>In Python, modules provide a means to group related functionality together. For
example we have already looked at and made use of the <code class="xref py py-mod docutils literal"><span class="pre">re</span></code> module, which
groups functionality for working with regular expressions.</p>
<p>In Python any file with a <code class="docutils literal"><span class="pre">.py</span></code> extension is a module. This means that the
file that we have been creating, <code class="docutils literal"><span class="pre">fasta_utils.py</span></code>, is a module.</p>
<p>To make use of the functionality within a module one needs to <code class="docutils literal"><span class="pre">import</span></code> it.
Let’s try this out in an interactive session</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python
</pre></div>
</div>
<p>Now we can import the module.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fasta_utils</span>  
<span class="go">Testing the is_description_line() function...</span>
<span class="go">Testing the extract_organism_name() function...</span>
</pre></div>
</div>
<p>Note that the tests run just like when we call the <code class="docutils literal"><span class="pre">fasta_utils.py</span></code>
script directly. This is an undesired side effect of the current
implementation. It would be better if the tests were not run when the module
is imported.</p>
<p>To improve the behaviour of the <code class="xref py py-mod docutils literal"><span class="pre">fasta_utils</span></code> module we will make use of a
special Python attribute called <code class="docutils literal"><span class="pre">__name__</span></code>, which provides a string representation
of <a class="reference internal" href="glossary.html#term-scope"><span class="xref std std-term">scope</span></a>. When commands are run from a script or the interactive prompt the
name attribute is set to <code class="docutils literal"><span class="pre">__main__</span></code>. When a module is imported the <code class="docutils literal"><span class="pre">__name__</span></code>
attribute is set to the name of the module.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="go">__main__</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">fasta_utils</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  
<span class="go">fasta_utils</span>
</pre></div>
</div>
<p>Using this information we can update the <code class="docutils literal"><span class="pre">fasta_utils.py</span></code> file with
the changes highlighted below.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class="hll">    <span class="n">test_is_description_line</span><span class="p">()</span>
</span><span class="hll">    <span class="n">test_extract_organism_name</span><span class="p">()</span>
</span></pre></div>
</td></tr></table></div>
<p>Let us make sure that the tests still run if we run the script directly.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
</pre></div>
</div>
<p>Now we can reload the module in the interactive prompt we were working in
earlier to make sure that the tests no longer get executed.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">reload</span><span class="p">(</span><span class="n">fasta_utils</span><span class="p">)</span>  
<span class="go">&lt;module &#39;fasta_utils&#39; from &#39;fasta_utils.py&#39;&gt;</span>
</pre></div>
</div>
<p>The test suite is no longer being called upon loading the module and no lines
logging the progress of the testing suite is being printed to the terminal.</p>
<p>Note that simply calling the <code class="docutils literal"><span class="pre">import</span> <span class="pre">fasta_utils</span></code> command again will not
actually detect the changes that we made to the <code class="docutils literal"><span class="pre">fasta_utils.py</span></code> file,
which is why we make use of Python’s built-in <code class="xref py py-func docutils literal"><span class="pre">reload()</span></code> function. Alternatively,
one could have exited the Python shell, using Ctrl-D or the <code class="xref py py-func docutils literal"><span class="pre">exit()</span></code> function,
and then started a new interactive Python session and imported the <code class="xref py py-mod docutils literal"><span class="pre">fasta_utils</span></code>
module again.</p>
</div>
<div class="section" id="counting-the-number-of-unique-organisms">
<h2>Counting the number of unique organisms</h2>
<p>We can now use the <code class="xref py py-mod docutils literal"><span class="pre">fasta_utils</span></code> module to start answering some of the
biological questions that we posed at the beginning of this chapter. For now
let us do this using an interactive Python shell.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python
Python 2.7.10 (default, Jul 14 2015, 19:46:27)
[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;
</pre></div>
</div>
<p>Now we will start by importing the modules that we want to use. In this case
<code class="xref py py-mod docutils literal"><span class="pre">fasta_utils</span></code> for processing the data and <code class="xref py py-mod docutils literal"><span class="pre">gzip</span></code> for opening and
reading in the data from the <code class="docutils literal"><span class="pre">uniprot_sprot.2015-11-26.fasta.gz</span></code> file.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fasta_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gzip</span>
</pre></div>
</div>
<p>Now we create a list for storing all the FASTA description lines.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fasta_desc_lines</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>We can then open the file using the <code class="xref py py-func docutils literal"><span class="pre">gzip.open()</span></code> function. Note that this
returns a file handle.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_handle</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;../data/uniprot_sprot.2015-11-26.fasta.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a <code class="docutils literal"><span class="pre">for</span></code> loop we can iterate over all the lines in the input file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">fasta_utils</span><span class="o">.</span><span class="n">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<span class="gp">... </span>         <span class="n">fasta_desc_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>When we are finished with the input file we must remember to close it.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Let’s check that the number of FASTA description lines using the built-in
<code class="xref py py-func docutils literal"><span class="pre">len()</span></code> function. This function returns the number of items
in the list, i.e. the length of the list.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">fasta_desc_lines</span><span class="p">)</span>
<span class="go">549832</span>
</pre></div>
</div>
<p>Okay now it is time to find the number of unique organisms. For this we will make
use of a data structure called <code class="docutils literal"><span class="pre">set</span></code>. In Python sets are used to compare
collections of unique elements. This means that sets are ideally suited for
operations that you may associate with Venn diagrams.</p>
<p>However, in this instance we simply use the <code class="docutils literal"><span class="pre">set</span></code> data structure to ensure
that we only get one unique representative of each organism. In other words
even if one calls the <code class="xref py py-func docutils literal"><span class="pre">set.add()</span></code> function several times with the same item
the item will only occur once in the set.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">organisms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_desc_lines</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">fasta_utils</span><span class="o">.</span><span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">organisms</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">organisms</span><span class="p">)</span>
<span class="go">13251</span>
</pre></div>
</div>
<p>Great, now we know that there are 13,251 unique organisms represented in the
FASTA file.</p>
</div>
<div class="section" id="finding-the-number-of-variants-per-species-and-the-number-of-proteins-per-variant">
<h2>Finding the number of variants per species and the number of proteins per variant</h2>
<p>Suppose we had a FASTA file containing only four entries with the description
lines below.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;sp|P12334|AZUR1_METJ Azurin iso-1 OS=Methylomonas sp. (strain J) PE=1 SV=2
&gt;sp|P12335|AZUR2_METJ Azurin iso-2 OS=Methylomonas sp. (strain J) PE=1 SV=1
&gt;sp|P23827|ECOT_ECOLI Ecotin OS=Escherichia coli (strain K12) GN=eco PE=1 SV=1
&gt;sp|B6I1A7|ECOT_ECOSE Ecotin OS=Escherichia coli (strain SE11) GN=eco PE=3 SV=1
</pre></div>
</div>
<p>The analysis in the previous section would have identified these as three
separate entities.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Methylomonas sp. (strain J)
Escherichia coli (strain K12)
Escherichia coli (strain SE11)
</pre></div>
</div>
<p>Now, suppose that we wanted to find out how many variants there were of each
species. In the example above there would be be one variant of <code class="docutils literal"><span class="pre">Methylomonas</span>
<span class="pre">sp.</span></code> and two variants of <code class="docutils literal"><span class="pre">Escherichia</span> <span class="pre">coli</span></code>. Furthermore, suppose that we
also wanted to find out how many proteins were associated with each variant.</p>
<p>We could achieve this by creating a nested data structure using Python’s built
in dictionary type. At the top level we should have a dictionary
whose keys were the species, e.g. <code class="docutils literal"><span class="pre">Escherichia</span> <span class="pre">coli</span></code>. The values in the top
level dictionary should themselves be dictionaries. The keys of the nested dictionaries
should be the full organism name, e.g. <code class="docutils literal"><span class="pre">Escherichia</span> <span class="pre">coli</span> <span class="pre">(strain</span> <span class="pre">K12)</span></code>. The values
in the nested dictionary should be an integer representing the number of proteins found
for that organism. Below is a YAML representation of the data structure that should be
created from the four entries above.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">Methylomonas sp.</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">Methylomonas sp. (strain J)</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="l l-Scalar l-Scalar-Plain">Escherichia coli</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">Escherichia coli (strain K12)</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="l l-Scalar l-Scalar-Plain">Escherichia coli (strain SE11)</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>So what type of functionality would we need to achieve this? First of all we need a
function that given an organism name returns the associated species. In other words
something that converts <code class="docutils literal"><span class="pre">Escherichia</span> <span class="pre">coli</span> <span class="pre">(strain</span> <span class="pre">K12)</span></code> to <code class="docutils literal"><span class="pre">Escherichia</span> <span class="pre">coli</span></code>.
Secondly, we need a function that given a list of organism names returns the data
structure described above.</p>
<p>Let us start by creating a test for converting the organism name into a species.
Add the test below to <code class="docutils literal"><span class="pre">fasta_utils.py</span></code>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">test_organism_name2species</span><span class="p">():</span>
</span><span class="hll">    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing the organism_name2species() function...&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">assert</span> <span class="n">organism_name2species</span><span class="p">(</span><span class="s2">&quot;Methylomonas sp. (strain J)&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Methylomonas sp.&quot;</span>
</span><span class="hll">    <span class="k">assert</span> <span class="n">organism_name2species</span><span class="p">(</span><span class="s2">&quot;Homo sapiens&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Homo sapiens&quot;</span>
</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_is_description_line</span><span class="p">()</span>
    <span class="n">test_extract_organism_name</span><span class="p">()</span>
<span class="hll">    <span class="n">test_organism_name2species</span><span class="p">()</span>
</span></pre></div>
</td></tr></table></div>
<p>Let’s find out what error this gives us.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 40, in &lt;module&gt;
    test_organism_name2species()
  File &quot;fasta_utils.py&quot;, line 34, in test_organism_name2species
    assert organism_name2species(&quot;Methylomonas sp. (strain J)&quot;) == &quot;Methylomonas sp.&quot;
NameError: global name &#39;organism_name2species&#39; is not defined
</pre></div>
</div>
<p>The error message is telling us that we need to define the
<code class="xref py py-func docutils literal"><span class="pre">organism_name2species()</span></code> function. Add the lines below to define it.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">organism_name2species</span><span class="p">(</span><span class="n">organism_name</span><span class="p">):</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Return the species from the FASTA organism name.&quot;&quot;&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>Now we get a new error message when we run the tests.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 43, in &lt;module&gt;
    test_organism_name2species()
  File &quot;fasta_utils.py&quot;, line 37, in test_organism_name2species
    assert organism_name2species(&quot;Methylomonas sp. (strain J)&quot;) == &quot;Methylomonas sp.&quot;
AssertionError
</pre></div>
</div>
<p>Great, let us add some logic to the function.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">organism_name2species</span><span class="p">(</span><span class="n">organism_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the species from the FASTA organism name.&quot;&quot;&quot;</span>
<span class="hll">    <span class="n">words</span> <span class="o">=</span> <span class="n">organism_name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>
</td></tr></table></div>
<p>Above, we split the organism name based on whitespace separators and return the
first two words joined by a space character.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Python, and many other scripting languages, strings can be concatenated using the <code class="docutils literal"><span class="pre">+</span></code> operator.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;hello&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;world&quot;</span>
<span class="go">&#39;hello world&#39;</span>
</pre></div>
</div>
</div>
<p>Time to test the code again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
</pre></div>
</div>
<p>Great, the function is working! Let us define a new test for the function that
will generate the nested data structure we described earlier.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">test_summarise_species_protein_data</span><span class="p">():</span>
</span><span class="hll">    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Testing summarise_species_protein_data() function...&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">fasta_desc_lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="hll"><span class="s2">&quot;&gt;sp|P12334|AZUR1_METJ Azurin iso-1 OS=Methylomonas sp. (strain J) PE=1 SV=2&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="s2">&quot;&gt;sp|P12335|AZUR2_METJ Azurin iso-2 OS=Methylomonas sp. (strain J) PE=1 SV=1&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="s2">&quot;&gt;sp|P23827|ECOT_ECOLI Ecotin OS=Escherichia coli (strain K12) GN=eco PE=1 SV=1&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="s2">&quot;&gt;sp|B6I1A7|ECOT_ECOSE Ecotin OS=Escherichia coli (strain SE11) GN=eco PE=3 SV=1&quot;</span>
</span><span class="hll">    <span class="p">]</span>
</span><span class="hll">    <span class="n">summary</span> <span class="o">=</span> <span class="n">summarise_species_protein_data</span><span class="p">(</span><span class="n">fasta_desc_lines</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># The top level dictionary will contain two entries.</span>
</span><span class="hll">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span><span class="hll">    <span class="k">assert</span> <span class="s2">&quot;Methylomonas sp.&quot;</span> <span class="ow">in</span> <span class="n">summary</span>
</span><span class="hll">    <span class="k">assert</span> <span class="s2">&quot;Escherichia coli&quot;</span> <span class="ow">in</span> <span class="n">summary</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># The value of the Methylomonas sp. entry is a dictionary with one</span>
</span><span class="hll">    <span class="c1"># entry in it.</span>
</span><span class="hll">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Methylomonas sp.&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
</span><span class="hll">    <span class="k">assert</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Methylomonas sp.&quot;</span><span class="p">][</span><span class="s2">&quot;Methylomonas sp. (strain J)&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># The value of the Escherichia coli entry is a dictionary with two</span>
</span><span class="hll">    <span class="c1"># entries in it.</span>
</span><span class="hll">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Escherichia coli&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span>
</span>    <span class="k">assert</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Escherichia coli&quot;</span><span class="p">][</span><span class="s2">&quot;Escherichia coli (strain K12)&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Escherichia coli&quot;</span><span class="p">][</span><span class="s2">&quot;Escherichia coli (strain SE11)&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_is_description_line</span><span class="p">()</span>
<span class="hll">    <span class="n">test_extract_organism_name</span><span class="p">()</span>
</span>    <span class="n">test_organism_name2species</span><span class="p">()</span>
    <span class="n">test_summarise_species_protein_data</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This should all be getting familiar now. Time to run the tests.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
Testing summarise_species_protein_data() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 70, in &lt;module&gt;
    test_summarise_species_protein_data()
  File &quot;fasta_utils.py&quot;, line 50, in test_summarise_species_protein_data
    summary = summarise_species_protein_data(fasta_desc_lines)
NameError: global name &#39;summarise_species_protein_data&#39; is not defined
</pre></div>
</div>
<p>Again we start by defining the function.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span> <span class="nf">summarise_species_protein_data</span><span class="p">(</span><span class="n">fasta_desc_lines</span><span class="p">):</span>
</span><span class="hll">    <span class="sd">&quot;&quot;&quot;Return data structure summarising the organism and protein data.&quot;&quot;&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>And then we run the tests again.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
Testing summarise_species_protein_data() function...
Traceback (most recent call last):
  File &quot;fasta_utils.py&quot;, line 74, in &lt;module&gt;
    test_summarise_species_protein_data()
  File &quot;fasta_utils.py&quot;, line 57, in test_summarise_species_protein_data
    assert len(summary) == 2
TypeError: object of type &#39;NoneType&#39; has no len()
</pre></div>
</div>
<p>Time to add an implementation.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>42
43
44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">summarise_species_protein_data</span><span class="p">(</span><span class="n">fasta_desc_lines</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return data structure summarising the organism and protein data.&quot;&quot;&quot;</span>
<span class="hll">    <span class="n">summary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span class="hll">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_desc_lines</span><span class="p">:</span>
</span><span class="hll">        <span class="n">variant_name</span> <span class="o">=</span> <span class="n">extract_organism_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span class="hll">        <span class="n">species_name</span> <span class="o">=</span> <span class="n">organism_name2species</span><span class="p">(</span><span class="n">variant_name</span><span class="p">)</span>
</span><span class="hll">        <span class="n">variant_dict</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">species_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
</span><span class="hll">        <span class="n">variant_dict</span><span class="p">[</span><span class="n">variant_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">variant_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variant_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class="hll">        <span class="n">summary</span><span class="p">[</span><span class="n">species_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">variant_dict</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">summary</span>
</span></pre></div>
</td></tr></table></div>
<p>In the above we make use of the dictionary’s built-in <code class="docutils literal"><span class="pre">get()</span></code> method, which
returns the value associated with the key provided as the first argument. If the
key does not yet exist in the dictionary it returns the second argument, the
default value.</p>
<p>On line 48 we try to access a <code class="docutils literal"><span class="pre">variant_dict</span></code> dictionary from within the <code class="docutils literal"><span class="pre">summary</span></code>
dictionary, we are in other words working with a nested data structure. If there
is no entry associated with the <code class="docutils literal"><span class="pre">species_name</span></code> the <code class="docutils literal"><span class="pre">get()</span></code> method will return
an empty dictionary (<code class="docutils literal"><span class="pre">dict()</span></code>).</p>
<p>On line 49 we keep count of the number of times a variant of a species, as defined
by the full organism name, has been observed. In this instance we
use the <code class="docutils literal"><span class="pre">get()</span></code> method to get the number of times the variant has been observed
previously and then we add 1 to it. If the variant has never been observed previously
it will not be in the dictionary and the <code class="docutils literal"><span class="pre">variant_dict.get(variant_name,</span> <span class="pre">0)</span></code> method
call will return 0 (the default value specified).</p>
<p>Line 50 updates the top level dictionary by adding the
<code class="docutils literal"><span class="pre">variant_dict</span></code> dictionary to the <code class="docutils literal"><span class="pre">summary</span></code> dictionary.</p>
<p>Let’s see if it the implementation works as expected.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ python fasta_utils.py
Testing the is_description_line() function...
Testing the extract_organism_name() function...
Testing the organism_name2species() function...
Testing summarise_species_protein_data() function...
</pre></div>
</div>
<p>Hurray!</p>
<p>Finally, let us write a separate script to convert an input FASTA file into a
YAML summary file. Create the file <code class="docutils literal"><span class="pre">fasta2yaml_summary.py</span></code> and add the
code below to it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">import</span> <span class="nn">fasta_utils</span>

<span class="n">fasta_desc_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<span class="k">with</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fasta_utils</span><span class="o">.</span><span class="n">is_description_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">fasta_desc_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">summary</span> <span class="o">=</span> <span class="n">fasta_utils</span><span class="o">.</span><span class="n">summarise_species_protein_data</span><span class="p">(</span><span class="n">fasta_desc_lines</span><span class="p">)</span>
<span class="n">yaml_text</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">explicit_start</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_text</span><span class="p">)</span>
</pre></div>
</div>
<p>In the code above we make use of the yaml module to convert our data structure
to the YAML file format. The PyYAML package is not part of the Python’s
standard library, but it is easily installed using <code class="docutils literal"><span class="pre">pip</span></code> (for more detailed
instructions see <a class="reference internal" href="managing-your-system.html#installing-python-packages"><span class="std std-ref">Installing Python packages</span></a>).</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ sudo pip install pyyaml
</pre></div>
</div>
<p>The script also makes use of <code class="docutils literal"><span class="pre">sys.stdin</span></code> and <code class="docutils literal"><span class="pre">sys.stdout</span></code> to read from
the <a class="reference internal" href="glossary.html#term-standard-input-stream"><span class="xref std std-term">standard input stream</span></a> and write to the <a class="reference internal" href="glossary.html#term-standard-output-stream"><span class="xref std std-term">standard output
stream</span></a>, respectively. This means that we can <a class="reference internal" href="glossary.html#term-pipe"><span class="xref std std-term">pipe</span></a> in the content to
our script and pipe output from our script.
For example to examine the YAML
output using the <code class="docutils literal"><span class="pre">less</span></code> pager one could use the command below.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ gunzip -c data/uniprot_sprot.2015-11-26.fasta.gz | python fasta2yaml_summary.py | less
</pre></div>
</div>
<p>This immediately reveals that there are organisms in the SwissProt FASTA file
that have few protein associated with them.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember the benefits of using pipes was described in <a class="reference internal" href="first-steps-towards-automation.html#creating-workflows-using-pipes"><span class="std std-ref">Creating a work flow using pipes</span></a>.</p>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>---
AKT8 murine:
  AKT8 murine leukemia virus: 1
AKV murine:
  AKV murine leukemia virus: 3
Abelson murine:
  Abelson murine leukemia virus: 3
Abies alba:
  Abies alba: 1
Abies balsamea:
  Abies balsamea: 3
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The formatting in the YAML file above was created for us by the call
to the <code class="docutils literal"><span class="pre">yaml.dump()</span></code> method in the <code class="docutils literal"><span class="pre">fasta2yaml_summary.py</span></code>
script.</p>
</div>
<p>Great work!</p>
</div>
<div class="section" id="key-concepts">
<h2>Key concepts</h2>
<ul class="simple">
<li>Think about the problem at hand before you start coding</li>
<li>Break down large tasks into smaller more manageable tasks, repeat until the
tasks seem trivial</li>
<li>Test-driven development is a software development practise that can help
break tasks into manageable chunks that can be tested</li>
<li>Many aspects of biological data processing boil down to string manipulations</li>
<li>Regular expressions are a powerful tool for performing string manipulations,
but use with caution as they can result in confusion</li>
<li>Python has many built-in packages for performing complex tasks, in this chapter
we used the <code class="xref py py-mod docutils literal"><span class="pre">re</span></code> package for working with regular expressions</li>
<li>There are also many third party Python packages that can be installed, in
this chapter we made use of the <code class="xref py py-mod docutils literal"><span class="pre">yaml</span></code> package for writing out a data
structure as a YAML file</li>
<li>If in doubt, turn to the abundance of resources for Python online including
manuals, tutorials and help forums</li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, otu.<br/>
    </p>
  </div>
</footer>
  </body>
</html>